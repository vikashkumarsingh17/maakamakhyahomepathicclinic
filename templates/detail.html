{% extends "base.html" %}
{% block content %}
<h2>Search Patient Detail</h2>
<form method="POST" class="mb-4">
    <input type="text" name="search" class="form-control" placeholder="Enter Patient ID or Name" required>
    <button type="submit" class="btn btn-primary mt-2">Search</button>
</form>

{% if patient %}
    {% for p in patient %}
        <div id="printArea" class="p-4 bg-white shadow rounded">
            <div class="text-center">
                <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/Emblem_of_India.svg" style="height:60px;">
                <h3 class="text-success">Maa Kamakhya Arogya Homeopathic Clinic</h3>
                <h5>Dr. Sandhya</h5>
                <small>Normal treatment: Medicine charges only | Critical: ‚Çπ300</small>
                <hr>
            </div>
            <table class="table table-bordered">
                <tr><th>Patient ID</th><td>{{ p[0] }}</td></tr>
                <tr><th>Name</th><td>{{ p[1] }}</td></tr>
                <tr><th>Age</th><td>{{ p[2] }}</td></tr>
                <tr><th>Gender</th><td>{{ p[3] }}</td></tr>
                <tr><th>Phone</th><td>{{ p[4] }}</td></tr>
                <tr><th>Address</th><td>{{ p[5] }}</td></tr>
                <tr><th>Problem</th><td>{{ p[6] }}</td></tr>
                <tr><th>Registration Date</th><td>{{ p[7] }}</td></tr>
            </table>
            <div class="text-center mt-3">
                <img src="{{ url_for('static', filename='qrcodes/patient_' ~ p[0] ~ '.png') }}" height="80">
                <p class="mt-3"><strong>Doctor Signature:</strong> ______________________</p>
            </div>
        </div>
        <div class="mt-3">
            <button class="btn btn-success" onclick="printDiv()">üñ® Print</button>
            <a href="{{ url_for('home') }}" class="btn btn-secondary">üè† Home</a>
            <a href="/print/{{ p[0] }}" class="btn btn-danger">Print Registeration Form</a>
        </div>
    {% endfor %}
{% elif patient is not none %}
    <p class="text-danger">No patient found.</p>
{% endif %}

<script>
function printDiv() {
    var printContents = document.getElementById("printArea").innerHTML;
    var originalContents = document.body.innerHTML;
    document.body.innerHTML = printContents;
    window.print();
    document.body.innerHTML = originalContents;
}
</script>
{% endblock %}
